<!DOCTYPE HTML>
<html>
<head>
<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0'>
<meta http-equiv='refresh' content=''>

<style>
#container
{
width:340px;
height:460px;
margin-left:auto;
margin-right:auto;
border:2px solid black;
background-color:#0080C0;
}
#header
{
color:white;
padding:5px;
text-align:center;
background-color:PaleGoldenRod;
}
#footer
{
clear:both;
margin:5px;
padding:5px;
text-align:right;
color:white;
background-color:#333;
}
input.selected
{
width:60px;
margin-left:10px;
text-align:center;
color:white;
font-family:Verdena, Arial, sans-serif;
font-size:18px;
font-weight:bold;
border:2px solid white;
background-color:blue;
}
input.unselected
{
width:60px;
margin-left:10px;
text-align:center;
color:black;
font-family:Verdena, Arial, sans-serif;
font-size:18px;
background-color:skyblue;
}
h1
{
padding:10px;
margin:0;
text-shadow:-3px 3px 10px rgba(226,227,166,1);
color:#ddd;
background-color:#111;
}
h2
{
margin:5px 5px 5px 5px;
text-align:center;
color:#111;
text-shadow:-1px -1px 2px rgba(215,217,132,1);
font-weight:bold;
background-color:#999;
}
a
{
text-decoration:none;
color:white;
}
#current,#tablespace
{
width:320px;
height:225px;
margin-top:5px;
margin-left:5px;
padding:5px;
background-color:tan;
}

#item-select
{
height:65px;
padding:5px;
background-color:darkslategrey;
}

#item_button
{
border-radius:5px;
width:20px;
height:20px;
margin-left:8px;
margin-top:2px;
text-align:center;
font-family:Verdena, Arial, sans-serif;
font-size:12px;
font-weight:bold;
background-color:lightgrey;
}

#item_button:hover
{
background-color:darkgoldenrod;
border-radius:5px;
}

#tables
{
overflow-y: scroll;
width:320px;
height:225px;
background-color:PaleGoldenRod;
}

#item_value,#item_number,#item_caption,.tbl_value,.rn,.rc
{
width:27px;
margin-left:5px;
margin-top:3px;
border-radius:5px;
text-align:right;
font-family:Verdena, Arial, sans-serif;
font-size:12px;
font-weight:bold;
background-color:lightgrey;
}


</style>
</head>

<body>
<script>
	sty();
	function sty()
		{
		add_Style('#item_button{width:69px;text-align:center;}');
		add_Style('#command_line{width:324px;height:25px;padding:3px;margin:5px;float-left;border:1px solid white;}');
		}
		
	function add_Style(styString)
		{
		var st = document.createElement('STYLE');
		t = document.createTextNode(styString);
		st.appendChild(t);
		document.head.appendChild(st);
		}
</script>

	<form action='wificonfig' method='POST'>
	<input id='' type='hidden' name='txtPage' value='Settings' placeholder=''/>
	<div id='container'>
		<div id='header'><h1>Vending Machine</h1></div>
		<div id='item-select'>	</div>
		<div id='tablespace'>	<div id='tables'></div>	</div>
		<div id='command_line'>	</div>
		<div id='footer'>		</div>
	</div>
<script>

	var current_item=2;
	var cmd_name = 'fill';
	draw_form();
	fD(current_item);
	function draw_form()
		{
		var count=0;
		while(count<10)
			{
			add_Button(count,'b','','item-select');
			count++;
			}
		var table_Row=0;
		var table_Col=0;
		var ind=0;
			add_Textbox(ind,'t','item_caption','width:150px;font-size:15px;text-align:center;margin:10px 5px 5px 5px','0','item-select');
			add_Button(98,'b','width:70px;','item-select');
			add_Button(99,'b','width:70px;','item-select');
			ind++;

		count=0;
		while(table_Row<12)
			{
			add_Textbox(table_Row,'rn','row_no','width:15px;text-align:right;background-color:lightgreen;',table_Row+1,'tables');
			add_Textbox(table_Row,'rc','row_cap','width:105px;text-align:left;background-color:lightgreen;','','tables');
			table_Col=0;
			var xz="";
			while(table_Col<4)
				{
				xz='t'+ind;
				add_Textbox(ind,xz,'data_val','width:32px;text-align:right;',ind,'tables');
				table_Col ++;
				ind++;
				}
			table_Row++;
			CR=document.createElement('BR');
			document.getElementById('tables').appendChild(CR);
			}
		count=11;
		add_Button(count,'b','width:70px;','command_line');
		
		
		}

	function add_Textbox(cnt,id_prefix,class_id,ex_sty,txtval,region)
		{
		t=document.createElement('INPUT');
		t.setAttribute('type','text');
		t.setAttribute('id',id_prefix+cnt);
		t.setAttribute('class',class_id);
		if((id_prefix=='rn')||(id_prefix=='rc'))
			{t.setAttribute('readonly','true');}
		if(txtval)
			t.setAttribute('value',txtval);
		if(ex_sty)
			t.setAttribute('style',ex_sty);
		document.getElementById(region).appendChild(t);
		}
	
	function add_Button(cnt,id_prefix,ex_sty,region)
		{
		var clickfun='fD('+cnt+')';
		id_prefix += cnt;
		var b=document.createElement('INPUT');
		b.setAttribute('type','button');
		b.setAttribute('id',id_prefix);
		if(ex_sty)
			b.setAttribute('style',ex_sty);
		b.setAttribute('class','tbl_value');
		if(cnt==current_item)
			{
			b.setAttribute('style','background-color:tan;');
			}
		b.setAttribute('value',cnt+1);
		b.setAttribute('onclick',clickfun);
		document.getElementById(region).appendChild(b);cnt++;
		}

	function sD(cx)
		{
		const xhttp=new XMLHttpRequest();
		xhttp.onload=function()
			{
			var VArr;
				var response=this.responseText;
			if((cmd_name=='fill')||(cmd_name=='cancel')||(cmd_name=='default'))
				{
				VArr = response.split(',');
				while(cnt<49)
					{
					var yy = 't' + cnt;
					document.getElementById(yy).value = VArr[cnt];
					cnt++;
					}
				}
			}
		xhttp.open('POST', 'postData');
		xhttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
		var cnt=0;
		
		var sendData= 'Cmd_Name=';
		sendData+=cmd_name;
		sendData+='&ItemNo=';
		sendData+=cx;
		sendData+='&ItemData=';
		if(cmd_name=='save')
			{
			while(cnt<49)
				{
				var yy='t'+cnt;
				sendData+=document.getElementById(yy).value;
				sendData+=',';
				cnt++;
				}
			
			}
		xhttp.send(sendData);
		}
	
	function fD(cx)
		{
		var zz = 'b'+current_item;
		if(cx==98)
			{cmd_name='test'; cx=current_item;}
		else if(cx==99)
			{cmd_name='save'; cx=current_item;}
		else
			{cmd_name='fill'; current = cx;}
		document.getElementById(zz).style = 'background-color:lightgrey;';
		zz = 'b'+cx;
		document.getElementById(zz).style = 'background-color:tan;';
		sD(cx);
		}
	</script>
</form>
</body>
</html>
